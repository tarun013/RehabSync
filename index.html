<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RehabSync</title>
    <link rel="stylesheet" href="style.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- MediaPipe Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js" crossorigin="anonymous"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <!-- Profile Selection View -->
    <div id="profile-view" class="view-section" style="display: none;">
        <div class="profile-container fade-in">
            <h1 class="profile-title">Who's Moving Today?</h1>
            <div class="profile-grid" id="profile-list">
                <!-- Profiles injected here -->
                <div class="profile-item add-profile-btn" id="add-profile-btn">
                    <div class="avatar add-avatar">+</div>
                    <span class="profile-name">Add Profile</span>
                </div>
            </div>

        </div>
    </div>

    <!-- Create Profile Modal (Hidden) -->
    <div id="create-profile-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content glass-panel">
            <h2>Create Profile</h2>
            <input type="text" id="new-profile-name" placeholder="Name" maxlength="15">
            <div class="color-picker">
                <div class="color-option selected" data-color="#00ff88" style="background: #00ff88;"></div>
                <div class="color-option" data-color="#00ccff" style="background: #00ccff;"></div>
                <div class="color-option" data-color="#ff0088" style="background: #ff0088;"></div>
                <div class="color-option" data-color="#ffaa00" style="background: #ffaa00;"></div>
            </div>
            <div class="modal-actions">
                <button id="cancel-profile-btn" class="secondary-btn">Cancel</button>
                <button id="save-profile-btn" class="primary-btn">Save</button>
            </div>
        </div>
    </div>

    <!-- Dashboard View -->
    <div id="dashboard-view" class="view-section active">
        <div class="dashboard-container">
            <header class="dash-header">
                <div class="user-welcome">
                    <h2>Good Morning, <span id="user-name">Guest</span>!</h2>
                    <p>Ready to move?</p>
                </div>
                <div class="dash-actions">
                    <button id="logout-btn" class="icon-btn" title="Logout">
                        <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2"
                            fill="none">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                            <polyline points="16 17 21 12 16 7"></polyline>
                            <line x1="21" y1="12" x2="9" y2="12"></line>
                        </svg>
                    </button>
                    <button id="delete-profile-btn" class="icon-btn danger-btn" title="Delete Profile"
                        style="color: #ff4444;">
                        <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2"
                            fill="none">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                            </path>
                        </svg>
                    </button>
                </div>
            </header>

            <div class="stats-overview glass-panel">
                <h3>7-Day Streak</h3>
                <div class="streak-bar">
                    <div class="day active">M</div>
                    <div class="day active">T</div>
                    <div class="day">W</div>
                    <div class="day">T</div>
                    <div class="day">F</div>
                    <div class="day">S</div>
                    <div class="day">S</div>
                </div>
                <p class="streak-count" id="streak-count">0 Day Streak</p>
            </div>

            <div class="dashboard-grid">
                <div class="dash-card glass-panel">
                    <h3>Last Session</h3>
                    <div class="last-session-info">
                        <span class="highlight">Squats</span>
                        <span class="value">25 Reps</span>
                        <span class="sub">Excellent Form (92%)</span>
                    </div>
                </div>

                <div class="dash-card glass-panel highlight-card">
                    <h3>Today's Goal</h3>
                    <p>Complete 3 different exercises</p>
                    <div class="progress-ring-mini">1/3</div>
                </div>
            </div>

            <div class="dash-controls">
                <button id="start-workout-btn" class="primary-btn large-btn">Start New Workout</button>
                <button id="view-stats-btn" class="secondary-btn">View Full Stats</button>
            </div>
        </div>
    </div>

    <!-- Workout View (Initially Hidden) -->
    <div id="app" style="display: none;">
        <!-- Overlay UI -->
        <div class="ui-layer">
            <header class="glass-panel">
                <div class="header-left">
                    <button id="back-to-dash" class="icon-btn" title="Back to Dashboard">‚Üê</button>
                    <h1>RehabSync</h1>
                    <select id="exercise-select" class="exercise-select">
                        <option value="squat">Squat</option>
                        <option value="bicep_curl">Bicep Curl</option>
                        <option value="shoulder_press">Shoulder Press</option>
                        <option value="neck_stretch">Neck Stretch (Therapy)</option>
                        <option value="push_up">Push Up</option>
                    </select>
                </div>
                <div class="status-indicator">
                    <span id="status-dot" class="dot"></span>
                    <span id="status-text">Initializing...</span>
                    <span id="fps-counter" class="fps">0 FPS</span>
                </div>
            </header>

            <main class="workout-grid">
                <!-- LEFT PANEL -->
                <aside class="side-panel left-panel glass-panel">
                    <div class="metric-card">
                        <h3>Set Goal</h3>
                        <div class="set-controls">
                            <input type="number" id="target-reps" value="10" min="1" max="100">
                            <button id="reset-btn">Reset</button>
                        </div>
                    </div>

                    <div class="metric-card">
                        <h3>Feedback</h3>
                        <p id="feedback-text" class="feedback-text">Stand in frame to begin.</p>
                    </div>

                    <div class="metric-card guide-card">
                        <h3><span class="guide-icon">üìã</span> Protocol</h3>
                        <div id="exercise-guide-text" class="guide-text">
                            <!-- Guide steps injected here -->
                        </div>
                    </div>
                </aside>

                <!-- CENTER PANEL (VIDEO) -->
                <div class="video-container">
                    <video id="input_video" class="input_video" playsinline></video>
                    <canvas id="output_canvas" class="output_canvas"></canvas>
                    <div id="feedback-overlay" class="feedback-overlay"></div>
                </div>

                <!-- RIGHT PANEL -->
                <aside class="side-panel right-panel glass-panel">
                    <div class="metric-card">
                        <h3>Progress</h3>
                        <div class="progress-stats">
                            <div class="stat-item">
                                <span class="label">Reps</span>
                                <p id="rep-count" class="rep-value" data-prev-reps="0">0</p>
                            </div>
                            <div class="stat-item">
                                <span class="label">Current State</span>
                                <p id="current-state" class="state-value">Waiting...</p>
                            </div>
                        </div>
                    </div>

                    <div class="metric-card chart-card">
                        <h3>Posture Consistency</h3>
                        <canvas id="posture-chart"></canvas>
                    </div>

                    <div class="metric-card ai-learning-card">
                        <h3><span class="ai-icon">üß†</span> On-Device Learning</h3>
                        <div class="ai-stats">
                            <div class="stat-row">
                                <span class="label">Param:</span>
                                <span class="value" id="ai-param">Depth</span>
                            </div>
                            <div class="stat-row">
                                <span class="label">Baseline:</span>
                                <span class="value" id="ai-baseline">100¬∞</span>
                            </div>
                            <div class="stat-row highlight">
                                <span class="label">Personalized:</span>
                                <span class="value" id="ai-current">100¬∞</span>
                            </div>
                        </div>
                        <div class="learning-indicator" id="ai-indicator" style="opacity: 0;">
                            Updating Model...
                        </div>
                    </div>
                </aside>
            </main>
        </div>
    </div>

    <script type="module" src="js/main.js"></script>
</body>

</html>
</html>
